{"version":3,"sources":["webpack:///./src/pages/tickets.js"],"names":["onlyUnique","value","index","self","indexOf","ClgNetworkTemplate","state","filtre_domaine","filtre_affectation","onChange_domaine","ev","this","setState","target","onChange_affectation","ticket_filter","node","a_a","Produit__Produit","Service__Nom","Sous_cat_gorie_de_service__Nom","b_b","Agent__Nom_complet","Equipe__Nom","includes","render","tickets","props","data","allExportDeDemandeUtilisateurXlsxSheet1","edges","nbtickets","length","liste_produits","map","edge","liste_services","liste_sscat","filtre_a","concat","liste_equipes","liste_agents","filtre_b","fluid","style","marginTop","md","className","name","placeholder","onChange","bind","filter","item","i","nb","x","label","key","React","Component","pageQuery"],"mappings":"6VAgBA,SAASA,EAAWC,EAAOC,EAAOC,GAC9B,OAAOA,EAAKC,QAAQH,KAAWC,E,IAG7BG,E,oJAEJC,MAAQ,CACNC,eAAgB,GAChBC,mBAAoB,I,8CAGtBC,iBAAA,SAAiBC,GACjBC,KAAKC,SAAS,CAACL,eAAgBG,EAAGG,OAAOZ,MAAMO,mBAAmB,M,EAGlEM,qBAAA,SAAqBJ,GACrBC,KAAKC,SAAS,CAACJ,mBAAoBE,EAAGG,OAAOZ,MAAMM,eAAe,M,EAGlEQ,cAAA,SAAcC,GACZ,GAAiC,KAA9BL,KAAKL,MAAMC,gBAA2D,KAAlCI,KAAKL,MAAME,mBAChD,OAAO,EAET,IAAIS,EAAM,CAACD,EAAKE,iBAAiBF,EAAKG,aAAaH,EAAKI,gCACpDC,EAAM,CAACL,EAAKM,mBAAmBN,EAAKO,aACxC,OAAQN,EAAIO,SAASb,KAAKL,MAAMC,iBAAmBc,EAAIG,SAASb,KAAKL,MAAME,qB,EAG7EiB,OAAA,WAIE,IAAMC,EAAUf,KAAKgB,MAAMC,KAAKC,wCAAwCC,MAClEC,EAAYL,EAAQM,OACpBC,EAAiBP,EAAQQ,KAAI,SAAAC,GAAI,OAAIA,EAAKnB,KAAKE,oBAC/CkB,EAAiBV,EAAQQ,KAAI,SAAAC,GAAI,OAAIA,EAAKnB,KAAKG,gBAC/CkB,EAAcX,EAAQQ,KAAI,SAAAC,GAAI,OAAIA,EAAKf,kCACvCkB,EAAWL,EAAeM,OAAOH,EAAeG,OAAOF,IAEvDG,EAAgBd,EAAQQ,KAAI,SAAAC,GAAI,OAAIA,EAAKnB,KAAKO,eAC9CkB,EAAef,EAAQQ,KAAI,SAAAC,GAAI,OAAIA,EAAKnB,KAAKM,sBAC7CoB,EAAWF,EAAcD,OAAOE,GAEtC,OAAQ,kBAAC,IAAD,KAEN,kBAAC,IAAD,MACE,kBAAC,IAAD,CAAWE,OAAO,EAAMC,MAAO,CAACC,UAAU,SACxC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKC,GAAG,KAAKC,UAAU,mBAAvB,YAAmDhB,EAAnD,MAEF,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKe,GAAG,KACR,kBAAC,IAAD,CAAQE,KAAK,QAAQ/C,MAAOU,KAAKL,MAAMC,eAAgB0C,YAAY,WAAWC,SAAUvC,KAAKF,iBAAiB0C,KAAKxC,OAClH2B,EAASc,OAAOpD,GAAYkC,KAAI,SAASmB,EAAMC,GAC9C,IAAIC,EAAGjB,EAASc,QAAQ,SAAAI,GAAC,OAAGA,GAAGH,KAAMrB,OACnC,OACI,kBAAC,IAAD,CAAQ/B,MAAOoD,EAAMI,MAAOJ,EAAK,KAAKE,EAAG,IAAKG,IAAKJ,EAAGP,UAAU,2BAIxE,kBAAC,IAAD,CAAKD,GAAG,KACR,kBAAC,IAAD,CAAQE,KAAK,QAAQ/C,MAAOU,KAAKL,MAAME,mBAAoByC,YAAY,cAAcC,SAAUvC,KAAKG,qBAAqBqC,KAAKxC,OAC7H+B,EAASU,OAAOpD,GAAYkC,KAAI,SAASmB,EAAMC,GAC9C,IAAIC,EAAGb,EAASU,QAAQ,SAAAI,GAAC,OAAGA,GAAGH,KAAMrB,OACnC,OACI,kBAAC,IAAD,CAAQ/B,MAAOoD,EAAMI,MAAOJ,EAAK,KAAKE,EAAG,IAAKG,IAAKJ,EAAGP,UAAU,4BAMxErB,EAAQQ,KAAI,SAASC,EAAMmB,GAC1B,OAAG3C,KAAKI,cAAcoB,EAAKnB,MAE1B,kBAAC,IAAD,CAAK0C,IAAKJ,GACR,kBAAC,IAAD,CAAKR,GAAG,MACL,kBAAC,IAAD,CAAW9B,KAAMmB,EAAKnB,cAGtB,IACPL,S,GA5EqBgD,IAAMC,WAmFxBvD,YAER,IAAMwD,EAAS","file":"component---src-pages-tickets-js-f47023dd3ccd642e8a4a.js","sourcesContent":["import React from \"react\"\r\nimport { graphql } from 'gatsby'\r\nimport Layout from \"../components/layout\"\r\n\r\nimport Container from 'muicss/lib/react/container';\r\nimport Row from 'muicss/lib/react/row';\r\nimport Col from 'muicss/lib/react/col';\r\nimport Divider from 'muicss/lib/react/divider';\r\nimport Select from 'muicss/lib/react/select';\r\nimport Option from 'muicss/lib/react/option';\r\n\r\nimport ClgTitle from '../components/clgtitle'\r\nimport ClgMenu from '../components/clgmenu'\r\n\r\nimport ClgTicket from '../components/clgticket'\r\n\r\nfunction onlyUnique(value, index, self) {\r\n    return self.indexOf(value) === index;\r\n}\r\n\r\nclass ClgNetworkTemplate extends React.Component {\r\n\r\n  state = {\r\n    filtre_domaine: \"\",\r\n    filtre_affectation: \"\"\r\n  };\r\n\r\n  onChange_domaine(ev) {\r\n  this.setState({filtre_domaine: ev.target.value,filtre_affectation:\"\"});\r\n  }\r\n\r\n  onChange_affectation(ev) {\r\n  this.setState({filtre_affectation: ev.target.value,filtre_domaine:\"\"});\r\n  }\r\n\r\n  ticket_filter(node) {\r\n    if(this.state.filtre_domaine === \"\" && this.state.filtre_affectation === \"\" ){\r\n      return true\r\n    }\r\n    var a_a = [node.Produit__Produit,node.Service__Nom,node.Sous_cat_gorie_de_service__Nom]\r\n    var b_b = [node.Agent__Nom_complet,node.Equipe__Nom]\r\n    return  a_a.includes(this.state.filtre_domaine) || b_b.includes(this.state.filtre_affectation)\r\n  }\r\n\r\n  render() {\r\n\r\n\r\n  //  const info = this.props.data.clgListeXlsxRefClg\r\n    const tickets = this.props.data.allExportDeDemandeUtilisateurXlsxSheet1.edges\r\n    const nbtickets = tickets.length\r\n    const liste_produits = tickets.map(edge => edge.node.Produit__Produit)\r\n    const liste_services = tickets.map(edge => edge.node.Service__Nom)\r\n    const liste_sscat = tickets.map(edge => edge.Sous_cat_gorie_de_service__Nom)\r\n    const filtre_a = liste_produits.concat(liste_services.concat(liste_sscat))\r\n\r\n    const liste_equipes = tickets.map(edge => edge.node.Equipe__Nom)\r\n    const liste_agents = tickets.map(edge => edge.node.Agent__Nom_complet)\r\n    const filtre_b = liste_equipes.concat(liste_agents)\r\n\r\n    return (<Layout>\r\n\r\n      <Divider/>\r\n        <Container fluid={true} style={{marginTop:'22px'}}>\r\n          <Row>\r\n            <Col md=\"12\" className=\"mui--text-title\">TICKETS ({nbtickets})</Col>\r\n          </Row>\r\n          <Row>\r\n            <Col md=\"6\" >\r\n            <Select name='input' value={this.state.filtre_domaine} placeholder='Domaines' onChange={this.onChange_domaine.bind(this)}>\r\n            {filtre_a.filter(onlyUnique).map(function(item, i){\r\n              var nb=filtre_a.filter( x=> x==item).length\r\n                return (\r\n                    <Option value={item} label={item+\" (\"+nb+\")\"} key={i} className=\"mui--text-caption\"/>\r\n                )})}\r\n            </Select>\r\n            </Col>\r\n            <Col md=\"6\" >\r\n            <Select name='input' value={this.state.filtre_affectation} placeholder='Affectation' onChange={this.onChange_affectation.bind(this)}>\r\n            {filtre_b.filter(onlyUnique).map(function(item, i){\r\n              var nb=filtre_b.filter( x=> x==item).length\r\n                return (\r\n                    <Option value={item} label={item+\" (\"+nb+\")\"} key={i} className=\"mui--text-caption\"/>\r\n                )})}\r\n            </Select>\r\n            </Col>\r\n          </Row>\r\n          {\r\n            tickets.map(function(edge, i){\r\n             if(this.ticket_filter(edge.node)){\r\n              return (\r\n              <Row key={i}>\r\n                <Col md=\"12\">\r\n                   <ClgTicket node={edge.node} />\r\n                </Col>\r\n              </Row>)\r\n            }else {return}\r\n          },this)}\r\n      </Container>\r\n\r\n    </Layout>)\r\n  }\r\n}\r\n\r\nexport default ClgNetworkTemplate\r\n\r\nexport const pageQuery = graphql `\r\n    query TicketsQuery {\r\n      allExportDeDemandeUtilisateurXlsxSheet1(filter: {}, sort: {fields: Derni_re_mise___jour, order: DESC}) {\r\n          edges {\r\n            node {\r\n              Agent__Nom_complet\r\n              Date_de_d_but(formatString: \"dddd DD/MM/YY\", locale: \"fr\")\r\n              Demandeur__Nom_complet\r\n              Derni_re_mise___jour(formatString: \"dddd DD/MM/YY\", locale: \"fr\")\r\n              Description\r\n              Equipe__Nom\r\n              Etablissement_concern___Nom_complet\r\n              Etablissement_concern___Num_ro_UAI_d__tablissement\r\n              Etablissement_concern___T_l_phone\r\n              Famille_de_produit__Nom\r\n              N__d_inventaire\r\n              Nombre_de_relances\r\n              Objet_de_la_demande\r\n              Priorit_\r\n              Produit__Produit\r\n              R_f_rence\r\n              Service__Nom\r\n              Sous_cat_gorie_de_service__Nom\r\n              Statut\r\n              T_l_phone_de_rappel\r\n              Urgence\r\n            }\r\n          }\r\n        }\r\n\r\n}\r\n  `\r\n"],"sourceRoot":""}